{"ast":null,"code":"\"use strict\";\n\n// Output Feedback\nvar _classCallCheck = require(\"/Users/aryanbindroo/eth-waterloo/frontend/node_modules/@babel/runtime/helpers/classCallCheck.js\").default;\nvar _createClass = require(\"/Users/aryanbindroo/eth-waterloo/frontend/node_modules/@babel/runtime/helpers/createClass.js\").default;\nvar _assertThisInitialized = require(\"/Users/aryanbindroo/eth-waterloo/frontend/node_modules/@babel/runtime/helpers/assertThisInitialized.js\").default;\nvar _inherits = require(\"/Users/aryanbindroo/eth-waterloo/frontend/node_modules/@babel/runtime/helpers/inherits.js\").default;\nvar _createSuper = require(\"/Users/aryanbindroo/eth-waterloo/frontend/node_modules/@babel/runtime/helpers/createSuper.js\").default;\nvar __classPrivateFieldSet = this && this.__classPrivateFieldSet || function (receiver, state, value, kind, f) {\n  if (kind === \"m\") throw new TypeError(\"Private method is not writable\");\n  if (kind === \"a\" && !f) throw new TypeError(\"Private accessor was defined without a setter\");\n  if (typeof state === \"function\" ? receiver !== state || !f : !state.has(receiver)) throw new TypeError(\"Cannot write private member to an object whose class did not declare it\");\n  return kind === \"a\" ? f.call(receiver, value) : f ? f.value = value : state.set(receiver, value), value;\n};\nvar __classPrivateFieldGet = this && this.__classPrivateFieldGet || function (receiver, state, kind, f) {\n  if (kind === \"a\" && !f) throw new TypeError(\"Private accessor was defined without a getter\");\n  if (typeof state === \"function\" ? receiver !== state || !f : !state.has(receiver)) throw new TypeError(\"Cannot read private member from an object whose class did not declare it\");\n  return kind === \"m\" ? f : kind === \"a\" ? f.call(receiver) : f ? f.value : state.get(receiver);\n};\nvar _OFB_iv, _OFB_lastPrecipher, _OFB_lastPrecipherIndex;\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\nexports.OFB = void 0;\nvar mode_js_1 = require(\"./mode.js\");\nvar OFB = /*#__PURE__*/function (_mode_js_1$ModeOfOper) {\n  _inherits(OFB, _mode_js_1$ModeOfOper);\n  var _super = _createSuper(OFB);\n  function OFB(key, iv) {\n    var _this;\n    _classCallCheck(this, OFB);\n    _this = _super.call(this, \"OFB\", key, OFB);\n    _OFB_iv.set(_assertThisInitialized(_this), void 0);\n    _OFB_lastPrecipher.set(_assertThisInitialized(_this), void 0);\n    _OFB_lastPrecipherIndex.set(_assertThisInitialized(_this), void 0);\n    if (iv) {\n      if (iv.length % 16) {\n        throw new TypeError(\"invalid iv size (must be 16 bytes)\");\n      }\n      __classPrivateFieldSet(_assertThisInitialized(_this), _OFB_iv, new Uint8Array(iv), \"f\");\n    } else {\n      __classPrivateFieldSet(_assertThisInitialized(_this), _OFB_iv, new Uint8Array(16), \"f\");\n    }\n    __classPrivateFieldSet(_assertThisInitialized(_this), _OFB_lastPrecipher, _this.iv, \"f\");\n    __classPrivateFieldSet(_assertThisInitialized(_this), _OFB_lastPrecipherIndex, 16, \"f\");\n    return _this;\n  }\n  _createClass(OFB, [{\n    key: \"iv\",\n    get: function get() {\n      return new Uint8Array(__classPrivateFieldGet(this, _OFB_iv, \"f\"));\n    }\n  }, {\n    key: \"encrypt\",\n    value: function encrypt(plaintext) {\n      var _a, _b;\n      if (plaintext.length % 16) {\n        throw new TypeError(\"invalid plaintext size (must be multiple of 16 bytes)\");\n      }\n      var ciphertext = new Uint8Array(plaintext);\n      for (var i = 0; i < ciphertext.length; i++) {\n        if (__classPrivateFieldGet(this, _OFB_lastPrecipherIndex, \"f\") === 16) {\n          __classPrivateFieldSet(this, _OFB_lastPrecipher, this.aes.encrypt(__classPrivateFieldGet(this, _OFB_lastPrecipher, \"f\")), \"f\");\n          __classPrivateFieldSet(this, _OFB_lastPrecipherIndex, 0, \"f\");\n        }\n        ciphertext[i] ^= __classPrivateFieldGet(this, _OFB_lastPrecipher, \"f\")[(__classPrivateFieldSet(this, _OFB_lastPrecipherIndex, (_b = __classPrivateFieldGet(this, _OFB_lastPrecipherIndex, \"f\"), _a = _b++, _b), \"f\"), _a)];\n      }\n      return ciphertext;\n    }\n  }, {\n    key: \"decrypt\",\n    value: function decrypt(ciphertext) {\n      if (ciphertext.length % 16) {\n        throw new TypeError(\"invalid ciphertext size (must be multiple of 16 bytes)\");\n      }\n      return this.encrypt(ciphertext);\n    }\n  }]);\n  return OFB;\n}(mode_js_1.ModeOfOperation);\nexports.OFB = OFB;\n_OFB_iv = new WeakMap(), _OFB_lastPrecipher = new WeakMap(), _OFB_lastPrecipherIndex = new WeakMap();","map":{"version":3,"names":["_classCallCheck","require","default","_createClass","_assertThisInitialized","_inherits","_createSuper","mode_js_1","OFB","_mode_js_1$ModeOfOper","_super","key","iv","_this","call","_OFB_iv","set","_OFB_lastPrecipher","_OFB_lastPrecipherIndex","length","TypeError","__classPrivateFieldSet","Uint8Array","get","__classPrivateFieldGet","value","encrypt","plaintext","ciphertext","i","aes","_b","_a","decrypt","ModeOfOperation","exports"],"sources":["/Users/aryanbindroo/eth-waterloo/frontend/node_modules/aes-js/src.ts/mode-ofb.ts"],"sourcesContent":["// Output Feedback\n\nimport { ModeOfOperation } from \"./mode.js\";\n\nexport class OFB extends ModeOfOperation {\n  #iv: Uint8Array;\n  #lastPrecipher: Uint8Array;\n  #lastPrecipherIndex: number;\n\n  constructor(key: Uint8Array, iv?: Uint8Array) {\n    super(\"OFB\", key, OFB);\n\n    if (iv) {\n      if (iv.length % 16) {\n        throw new TypeError(\"invalid iv size (must be 16 bytes)\");\n      }\n      this.#iv = new Uint8Array(iv);\n    } else {\n      this.#iv = new Uint8Array(16);\n    }\n\n    this.#lastPrecipher = this.iv;\n    this.#lastPrecipherIndex = 16;\n  }\n\n  get iv(): Uint8Array { return new Uint8Array(this.#iv); }\n\n  encrypt(plaintext: Uint8Array): Uint8Array {\n    if (plaintext.length % 16) {\n      throw new TypeError(\"invalid plaintext size (must be multiple of 16 bytes)\");\n    }\n\n    const ciphertext = new Uint8Array(plaintext);\n    for (let i = 0; i < ciphertext.length; i++) {\n      if (this.#lastPrecipherIndex === 16) {\n          this.#lastPrecipher = this.aes.encrypt(this.#lastPrecipher);\n          this.#lastPrecipherIndex = 0;\n      }\n      ciphertext[i] ^= this.#lastPrecipher[this.#lastPrecipherIndex++];\n    }\n\n    return ciphertext;\n  }\n\n  decrypt(ciphertext: Uint8Array): Uint8Array {\n    if (ciphertext.length % 16) {\n        throw new TypeError(\"invalid ciphertext size (must be multiple of 16 bytes)\");\n    }\n    return this.encrypt(ciphertext);\n  }\n}\n"],"mappings":"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"},"metadata":{},"sourceType":"script","externalDependencies":[]}